# 生产环境配置示例（阿里云服务器）
# 复制此文件为 .env.prod 并修改相应配置

# 应用配置
NODE_ENV=production
APP_PORT=3001

# MySQL 数据库配置
MYSQL_ROOT_PASSWORD=root3651257
MYSQL_DATABASE=yuwen_cuoti7225
MYSQL_USER=yuwen_user
MYSQL_PASSWORD=yuwen_password7225
MYSQL_PORT=3307
MYSQL_DATA_DIR=./data/mysql

# MySQL 内存配置（512M 限制优化方案）
# 
# 512M 内存分配建议：
#   - InnoDB Buffer Pool: 128M（最重要的缓存，约占总内存的 25%）
#   - 连接内存: 50个连接 × 2M = 100M
#   - 临时表: 32M
#   - 键缓冲区: 16M
#   - 排序/读取缓冲区: 4M
#   - 其他开销: ~232M
#   - 总计: ~512M
#
# MYSQL_BUFFER_POOL_SIZE: InnoDB 缓冲池大小（MySQL 最重要的内存参数）
#   512M 限制推荐: 128M（约占总内存的 25%）
#   这是 MySQL 用于缓存数据和索引的内存，直接影响性能
#   ✅ 128M 可以缓存约 15,000-30,000 条记录，性能较好
MYSQL_BUFFER_POOL_SIZE=128M

# Docker 容器内存限制
# MYSQL_MEMORY_LIMIT: MySQL 容器最大内存限制
#   512M 限制：严格限制为 512M
#   包括：buffer pool 128M + 连接内存 100M + 临时表 32M + 其他开销 ~252M
MYSQL_MEMORY_LIMIT=512M

# MYSQL_MEMORY_RESERVATION: MySQL 容器保证内存（系统保证分配）
#   512M 限制推荐: 384M（保证 MySQL 至少有 384M 可用内存）
#   防止内存不足时 MySQL 被 OOM 杀死
MYSQL_MEMORY_RESERVATION=384M

# 应用容器内存配置（1GB 服务器优化）
# APP_MEMORY_LIMIT: 应用容器最大内存限制
#   1GB 服务器推荐: 384M（给应用容器分配约 38% 的总内存）
APP_MEMORY_LIMIT=384M

# APP_MEMORY_RESERVATION: 应用容器保证内存
#   1GB 服务器推荐: 256M
APP_MEMORY_RESERVATION=256M

# 数据库连接配置（应用使用）
# DB_HOST: 数据库主机地址
#   - 在 Docker 环境中使用: mysql (docker-compose 服务名)
#   - 如果 MySQL 在外部服务器，使用实际的主机地址或 IP
DB_HOST=mysql

# 注意：以下 DB_* 配置会在 docker-compose 中自动从 MYSQL_* 映射
# docker-compose.prod.yml 会自动设置：
#   DB_USER=${MYSQL_USER}
#   DB_PASSWORD=${MYSQL_PASSWORD}
#   DB_NAME=${MYSQL_DATABASE}

# AI 模型配置
# AI_PROVIDER: 默认使用的 AI 模型提供商 (gemini/deepseek/qwen)
AI_PROVIDER=deepseek

# API Keys (根据选择的 AI_PROVIDER 配置对应的 API Key)
# Gemini API Key (当 AI_PROVIDER=gemini 时使用)
# GEMINI_API_KEY=your_gemini_api_key_here

# DeepSeek API Key (当 AI_PROVIDER=deepseek 时使用)
DEEPSEEK_API_KEY=sk-ca06ad5cee4a4ac7a8d577ceb5f66f1f

# Qwen API Key (当 AI_PROVIDER=qwen 时使用)
# QWEN_API_KEY=your_qwen_api_key_here

